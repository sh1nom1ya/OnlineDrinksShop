@page
@model EmailModel
@{
    ViewData["Title"] = "Manage Email";
    ViewData["ActivePage"] = ManageNavPages.Email;
}


<partial name="_StatusMessage" for="StatusMessage" />



<h2>Изменение почты</h2>
<form id="email-form" method="post" class="inp">
    <div>
        <label for="email">Электронная почта</label>
        <input required
               class="inputprof form-control"
               type="text"
               id="email"
               name="email"
               autocomplete="email"
               title="Введите вашу электронную почту.">
    </div>
    <li class="verf"> <a href="#">Отправить письмо с подтверждением</a></li>
    <div>
        <label for="new-email">Новая электронная почта</label>
        <input required
               class="inputprof form-control"
               type="text"
               id="new-email"
               name="new-email"
               autocomplete="email"
               title="Введите вашу новую электронную почту.">
    </div>
    <button class="save">Сохранить</button>
</form>



    @*<div class="row">
            <div class="col-md-6">
                <form id="email-form" method="post">
                    <div asp-validation-summary="All" class="text-danger" role="alert"></div>
                    @if (Model.IsEmailConfirmed)
                    {
                        <div class="form-floating mb-3 input-group">
                            <input asp-for="Email" class="inputprof form-control" placeholder="Please enter your email." disabled />
                                <div class="input-group-append">
                                    <span class="h-100 input-group-text text-success font-weight-bold">✓</span>
                                </div>
                            <label asp-for="Email" class="form-label"></label>
                        </div>
                    }
                    else
                    {
                        <div class="form-floating mb-3">
                            <input asp-for="Email" class="inputprof form-control" placeholder="Please enter your email." disabled />
                            <label asp-for="Email" class="form-label"></label>
                            <button id="email-verification" type="submit" asp-page-handler="SendVerificationEmail" class="btn btn-link">Send verification email</button>
                        </div>
                    }
                    <div class="form-floating mb-3">
                        <input asp-for="Input.NewEmail" class="form-control" autocomplete="email" aria-required="true" placeholder="Please enter new email." />
                        <label asp-for="Input.NewEmail" class="form-label"></label>
                        <span asp-validation-for="Input.NewEmail" class="text-danger"></span>
                    </div>
                    <button id="change-email-button" type="submit" asp-page-handler="ChangeEmail" class="w-100 btn btn-lg btn-primary">Change email</button>
                </form>
            </div>
        </div>*@

    @section Scripts {
        <partial name="_ValidationScriptsPartial" />

        @*<script>
        document.addEventListener("DOMContentLoaded", function () {
            const emailInput = document.getElementById("email");
            const newEmailInput = document.getElementById("new-email");

            function showError(input, message) {
                let error = input.nextElementSibling;
                if (!error || !error.classList.contains("error-message")) {
                    error = document.createElement("div");
                    error.classList.add("error-message");
                    input.parentNode.appendChild(error);
                }
                error.textContent = message;
            }

            function hideError(input) {
                const error = input.nextElementSibling;
                if (error && error.classList.contains("error-message")) {
                    error.remove();
                }
            }

            function validateEmail(input) {
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!emailRegex.test(input.value)) {
                    showError(input, "Введите корректный адрес электронной почты.");
                } else {
                    hideError(input);
                }
            }

            emailInput.addEventListener("blur", function () {
                validateEmail(this);
            });

            newEmailInput.addEventListener("blur", function () {
                validateEmail(this);
            });
        });
        </script>*@

    }
